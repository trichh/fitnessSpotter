var fitnessSpotter=angular.module("fitnessSpotter",["ngRoute","ngAnimate","cloudinary","ngFileUpload"]);angular.module("fitnessSpotter").config(["$routeProvider","$locationProvider",function(e,o){o.html5Mode(!0),e.when("/",{templateUrl:"views/home.html"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/admin/:gymName/add-client",{templateUrl:"views/addClient.html",controller:"NewClientCtrl"}).when("/admin/:gymName/dashboard",{templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).when("/admin/:gymName/edit",{templateUrl:"views/editUser.html",controller:"EditUserCtrl"}).when("/admin/:gymName/:clientId/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl"}).when("/admin/:gymName/:clientId/edit",{templateUrl:"views/editClient.html",controller:"EditClientCtrl"}).otherwise("/")}]).run(["$rootScope","$http",function(e,o){e.logout=function(){o.post("/logout")}}]),angular.module("fitnessSpotter").controller("DashboardCtrl",["$scope","$location","$http",function(e,o,t){t.get("/api/dashboard").then(function(o){console.log("SESSION DATA:",o.data.sessionData.passport.user),console.log("CLIENT DATA:",o.data.clientData),e.gymName=o.data.sessionData.passport.user.gymName,e.profilePicture=o.data.sessionData.passport.user.profilePicture,e.clients=o.data.clientData;var t=o.data.sessionData.passport.user.gymName;t=t.replace(/\s+/g,"-").toLowerCase(),e.dashboardRoute=t})["catch"](function(e){console.log(e)})}]),angular.module("fitnessSpotter").controller("EditClientCtrl",["$scope","$location","$http",function(e,o,t){t.get("/api/editClient").then(function(o){var t=o.data.sessionData.passport.user.gymName;t=t.replace(/\s+/g,"-").toLowerCase(),e.dashboardRoute=t})["catch"](function(e){console.log(e)})}]),angular.module("fitnessSpotter").controller("EditUserCtrl",["$scope","$location","$http",function(e,o,t){t.get("/api/editUser").then(function(o){var t=o.data.sessionData.passport.user.gymName;t=t.replace(/\s+/g,"-").toLowerCase(),e.dashboardRoute=t})["catch"](function(e){console.log(e)})}]),angular.module("fitnessSpotter").controller("LoginCtrl",["$rootScope","$scope","$location","$http",function(e,o,t,a){o.login=function(){var e=o.email,r=o.password;a.post("/api/login",{email:e,password:r}).success(function(e){var o=e.passport.user.gymName;o=o.replace(/\s+/g,"-").toLowerCase(),t.path("/admin/"+o+"/dashboard"),console.log("Authentication successful!")}).error(function(e){console.log("Authentication unsuccessful!",e),t.path("/")})}}]),angular.module("fitnessSpotter").controller("NewClientCtrl",["$scope","$location","$http","Upload","cloudinary",function(e,o,t,a,r){t.get("/api/add-client").then(function(o){var t=o.data.sessionData.passport.user.gymName;t=t.replace(/\s+/g,"-").toLowerCase(),e.dashboardRoute=t})["catch"](function(e){console.log(e)}),e.uploadImage=function(o){e.files=o,e.files&&angular.forEach(o,function(o){o&&!o.$error&&(o.upload=a.upload({url:"https://api.cloudinary.com/v1_1/"+r.config().cloud_name+"/upload",data:{upload_preset:r.config().upload_preset,tags:"myphotoalbum",file:o}}).success(function(t,a,r,l){o.result=t;var n=t.url;e.photo=n}).error(function(e,t,a,r){o.result=e}))})},e.addClient=function(){var o=e.fullName,a=e.weight,r=e.photo,l=e.workoutPlan,n=e.mealPlan,s=e.clientAssessment;t.post("/api/add-client",{name:o,weight:a,profilePicture:r,workoutPlan:l,mealPlan:n,clientAssessment:s}).then(function(e){console.log("COMING BACK: ",e)})}}]),angular.module("fitnessSpotter").controller("ProfileCtrl",["$scope","$location","$http",function(e,o,t){window.location.reload(!0),t.get("/api/profile").then(function(o){var t=o.data.sessionData.passport.user.gymName;t=t.replace(/\s+/g,"-").toLowerCase(),e.dashboardRoute=t})["catch"](function(e){console.log(e)})}]),angular.module("fitnessSpotter").controller("RegisterCtrl",["$scope","$location","$http","Upload","cloudinary",function(e,o,t,a,r){e.uploadImage=function(o){e.files=o,e.files&&angular.forEach(o,function(o){o&&!o.$error&&(o.upload=a.upload({url:"https://api.cloudinary.com/v1_1/"+r.config().cloud_name+"/upload",data:{upload_preset:r.config().upload_preset,tags:"myphotoalbum",file:o}}).success(function(t,a,r,l){o.result=t;var n=t.url;e.photo=n}).error(function(e,t,a,r){o.result=e}))})},e.register=function(){var o=e.email,a=e.password,r=e.name,l=e.photo,n=e.number,s=e.basic,i=e.plus,c=e.premium,u=e.cardName,p=e.cardNumber,d=e.securityCode,m=e.month,f=e.year;if(void 0!==typeof s&&void 0===i&&void 0===c)var g=s;else if(void 0!==typeof i&&void 0===s&&void 0===c)var g=i;else if(void 0!==typeof c&&void 0===s&&void 0===i)var g=c;t.post("/api/register",{email:o,password:a,gymName:r,profilePicture:l,phoneNumber:n,paymentPlan:g,cardHolder:u,cardNumber:p,securityCode:d,month:m,year:f}).then(function(e){console.log("COMING BACK: ",e)}),e.email="",e.password="",e.name="",e.number="",e.basic="",e.plus="",e.premium="",e.cardName="",e.cardNumber="",e.securityCode="",e.month="",e.year=""}}]);